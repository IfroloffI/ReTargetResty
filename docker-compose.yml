version: '3.8'

services:
  openresty:
    image: openresty/openresty:latest
    container_name: ReTargetOpenResty
    command: sh -c "groupadd -g 101 nginx && useradd -u 101 -g nginx nginx && nginx -g 'daemon off;'"
    volumes:
      - ./nginx.conf:/usr/local/openresty/nginx/conf/nginx.conf
      - ./logs:/usr/local/openresty/nginx/logs
      - /home/ubuntu/frontend_2025_1_RePresent/dist:/www-data
      - ./lua-scripts:/usr/local/openresty/lua-scripts
    ports:
      - "80:80"
      - "443:443"
    networks:
      - retarget_network
    restart: unless-stopped

networks:
  retarget_network:
    driver: bridge
    name: retarget_network
